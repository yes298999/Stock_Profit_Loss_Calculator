<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‚¡ç¥¨ç›ˆè™§è¨ˆç®—å™¨</title>
    <style>
	
		/* 			  === ã€ç‰ˆæ¬Šå®£è¨€ã€‘ ===
		
			@ ç¨‹å¼é–‹ç™¼è€…ï¼šå¯Œé€” - ç™¼å“¥ ã€å…è²»æŒ‡æ¨™ç‹ã€‘
			@ ç™¼å“¥å…è²»æŒ‡æ¨™ç‹çš„å€‹äººä¸»é  - ç‰›ç‰›åœˆ 
					https://q.futunn.com/hk/profile/27543329/
			@ ã€ç™¼å“¥å…è²»æŒ‡æ¨™ç‹ã€‘æ¸¯ç¾è‚¡ç¥¨äº¤æµè¨è«–é »é“ï¼Œåˆ†äº«æ›´å¤šå…è²»æŒ‡æ¨™ï¼š 
					https://snsim.futunn.com/share/server/j84D5?lang=zh-hk
			@ æˆæ¬Šä»»ä½•å€‹äººå¯ä»¥å…è²»ä½¿ç”¨ã€åˆ†ç™¼ã€ä¿®æ”¹å’Œåˆ†äº«ã€‚
			@ ä½†æ˜¯ï¼Œå¿…é ˆä¿ç•™ä»¥ä¸Šå…¨éƒ¨ã€ç‰ˆæ¬Šå®£è¨€ã€‘åœ¨é ‚ç«¯ä½ç½®ã€‚ä¸å¾—ä½œå‡ºä»»ä½•åˆªé™¤æˆ–è€…ä¿®æ”¹ã€‚
		*/

	
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        body {
            padding: 20px;
            line-height: 1.6;
            background-color: #f9f9f9;
            font-size: 16px;
        }
        .outer-wrapper {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            border-radius: 10px;
            background-color: #f0f8ff;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        .calc-section {
            margin: 15px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        /* æ–°å¢ï¼šç™¾åˆ†æ¯”å€é–“ç¨ç«‹DIVæ¨£å¼ */
        .percentage-section {
            margin: 15px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        /* å…©æ¬„æ©«æ’ä½ˆå±€å®¹å™¨ */
        .two-column-container {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }
        /* éŸ¿æ‡‰å¼é©é…ï¼šå°è¢å¹•è‡ªå‹•æ›è¡Œ */
        @media (max-width: 768px) {
            .two-column-container {
                flex-direction: column;
            }
        }
        /* æ¯æ¬„ä½”æ¯”å‡åˆ† */
        .two-column-item {
            flex: 1;
            min-width: 280px; /* æœ€å°å¯¬åº¦ï¼Œé¿å…éçª„ */
        }
        .input-group {
            display: inline-flex;
            align-items: center;
            margin-right: 15px;
            margin-bottom: 10px;
        }
        .input-group label {
            margin-right: 8px;
            font-weight: 600;
        }
        .input-group input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 120px;
        }
        button {
            padding: 8px 20px;
            color: white;
            border: none;
            border-radius: 9999px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 8px;
            /* éæ¸¡æ•ˆæœï¼Œè®“é¡è‰²åˆ‡æ›æ›´æµæš¢ */
            transition: background-color 0.2s ease;
        }
        #calculateBtn, #colorPickerBtn, #fontIncreaseBtn, #fontDecreaseBtn {
            width: 46px;
            height: 46px;
            padding: 0;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            font-size: 37px;
            line-height: 1;
        }
        .profit {
            color: green;
            font-weight: bold;
        }
        .loss {
            color: red;
            font-weight: bold;
        }
        .neutral {
            color: #666;
            font-weight: bold;
        }
        .table-container {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        table {
            border-collapse: collapse;
            width: 100%; /* æ”¹ç‚º100%ï¼Œé©æ‡‰çˆ¶å®¹å™¨å¯¬åº¦ */
            margin: 0 auto;
        }
        th, td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
            width: 33.33%;
        }
        th {
            background-color: #f8f9fa;
        }
        .section-title {
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .invalid-input {
            border: 1px solid red !important;
        }
        /* æ¨™é¡Œç›¸é—œæ¨£å¼ */
        .font-bold {
            font-weight: 700;
        }
        /* å–®ç¨è¨­ç½®ä¸»æ¨™é¡Œé¡è‰²ï¼Œç¢ºä¿ç‚º#3B82F6 */
        .header-main-title {
            color: #3B82F6 !important;
            font-weight: 700 !important;
        }
        .text-gray-600 {
            color: #4b5563 !important; /* å‰¯æ¨™é¡Œé¡è‰² */
        }
        .text-center {
            text-align: center;
        }
        .mb-2 {
            margin-bottom: 0.5rem;
        }
        .mb-8 {
            margin-bottom: 2rem;
        }
        /* ç§»é™¤é€£çµåº•ç·š */
        .header-link {
            text-decoration: none !important;
        }
    </style>
</head>
<body>
    <div class="outer-wrapper" id="outerWrapper">
        <!-- é é¢æ¨™é¡Œ -->
        <header class="text-center mb-8">
            <!-- ä½¿ç”¨å–®ç¨é¡åå¼·åˆ¶è¨­ç½®é¡è‰²ï¼Œç¢ºä¿ä¸æ˜¯é»‘è‰² -->
            <h1 style="font-size: 2.0rem !important;" class="header-main-title mb-2">è‚¡ç¥¨ç›ˆè™§è¨ˆç®—å™¨</h1>
            <p class="text-gray-600">
                <a href='https://snsim.futunn.com/share/server/j84D5?lang=zh-hk' target='_blank' class="header-link">
                    ç”± å¯Œé€” ã€ç™¼å“¥å…è²»æŒ‡æ¨™ç‹ã€‘ ç·¨å¯«å…è²»åˆ†äº«
                </a>
            </p>
        </header>

        <div id="inputDiv" class="calc-section">
            <div class="section-title">è¼¸å…¥è³‡æ–™</div>
            <div class="input-group">
                <label for="buyPrice">è²·å…¥åƒ¹ï¼š</label>
                <input type="text" id="buyPrice" placeholder="è«‹è¼¸å…¥è²·å…¥åƒ¹" oninput="validatePositiveNumber(this)" onkeypress="preventNonNumberKey(event, false)">
            </div>
            <div class="input-group">
                <label for="quantity">æ•¸é‡ï¼š</label>
                <input type="text" id="quantity" placeholder="è«‹è¼¸å…¥æ•¸é‡" oninput="validatePositiveInteger(this)" onkeypress="preventNonNumberKey(event, true)">
            </div>
            <div class="input-group">
                <label for="currentPrice">ç¾åƒ¹ï¼š</label>
                <input type="text" id="currentPrice" placeholder="è«‹è¼¸å…¥ç¾åƒ¹" oninput="validatePositiveNumber(this)" onkeypress="preventNonNumberKey(event, false)">
            </div>
            <button id="calculateBtn">ğŸ§®</button>
            <button id="colorPickerBtn">ğŸ¨</button>
            <button id="fontIncreaseBtn">ğŸ”¼</button>
            <button id="fontDecreaseBtn">ğŸ”½</button>
        </div>

        <div id="profitLossDiv" class="calc-section">
            <div class="section-title">å³æ™‚ç›ˆè™§è¨ˆç®—</div>
            <div id="realTimeResult">è«‹è¼¸å…¥è³‡æ–™ä¸¦é»æ“Šè¨ˆç®—æŒ‰éˆ•</div>
        </div>

        <div id="percentageDiv" class="calc-section">
            <div class="section-title">ç™¾åˆ†æ¯”ç›ˆè™§æ˜ç´°</div>
            <!-- ç©ºå®¹å™¨ï¼Œç”¨æ–¼å‹•æ…‹ç”Ÿæˆå››å€‹ç¨ç«‹çš„ç™¾åˆ†æ¯”å€é–“DIV -->
            <div id="percentageContent"></div>
        </div>

        <!-- é è…³ä¿¡æ¯ -->
        <footer class="text-center text-gray-500 text-sm mt-12">
            <p>Â© 2026 ã€è‚¡ç¥¨ç›ˆè™§è¨ˆç®—å™¨ã€‘ | <a href='https://snsim.futunn.com/share/server/j84D5?lang=zh-hk' target='_blank' class="header-link">ç”± å¯Œé€” ã€ç™¼å“¥å…è²»æŒ‡æ¨™ç‹ã€‘ ç·¨å¯«å…è²»åˆ†äº«</a></p>
        </footer>
    </div>

    <script>
        let currentFontScale = 1;
        const fontStep = 0.1;
        const minFontScale = 0.5;
        const maxFontScale = 2;

        // ç”Ÿæˆéš¨æ©Ÿæ·ºè‰²ï¼ˆé©åˆèƒŒæ™¯ï¼‰
        function getRandomLightColor() {
            const r = Math.floor(Math.random() * 75) + 180;
            const g = Math.floor(Math.random() * 75) + 180;
            const b = Math.floor(Math.random() * 75) + 180;
            return `rgb(${r}, ${g}, ${b})`;
        }

        // ç”Ÿæˆéš¨æ©ŸæŒ‰éˆ•ä¸»è‰²
        function getRandomBtnColor() {
            const r = Math.floor(Math.random() * 120) + 60;
            const g = Math.floor(Math.random() * 120) + 60;
            const b = Math.floor(Math.random() * 120) + 60;
            return `rgb(${r}, ${g}, ${b})`;
        }

        // é¡è‰²åŠ æ·±è™•ç†å‡½æ•¸
        function darkenColor(color, amount = 30) {
            const rgbMatch = color.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
            if (!rgbMatch) return color;
            let r = parseInt(rgbMatch[1]) - amount;
            let g = parseInt(rgbMatch[2]) - amount;
            let b = parseInt(rgbMatch[3]) - amount;
            r = r < 0 ? 0 : r;
            g = g < 0 ? 0 : g;
            b = b < 0 ? 0 : b;
            return `rgb(${r}, ${g}, ${b})`;
        }

        // è¨­ç½®æ‰€æœ‰æŒ‰éˆ•çš„éš¨æ©Ÿé¡è‰²å’Œæ‡¸æµ®æ•ˆæœ
        function setRandomBtnBgColor() {
            const buttons = [
                document.getElementById('calculateBtn'),
                document.getElementById('colorPickerBtn'),
                document.getElementById('fontIncreaseBtn'),
                document.getElementById('fontDecreaseBtn')
            ];

            buttons.forEach(btn => {
                if (btn) {
                    const originalColor = getRandomBtnColor();
                    const hoverColor = darkenColor(originalColor);
                    
                    // è¨­ç½®é»˜èªé¡è‰²
                    btn.style.backgroundColor = originalColor;
                    
                    // é¼ æ¨™æ‡¸æµ®äº‹ä»¶
                    btn.addEventListener('mouseover', function() {
                        this.style.backgroundColor = hoverColor;
                    });
                    
                    // é¼ æ¨™é›¢é–‹äº‹ä»¶
                    btn.addEventListener('mouseout', function() {
                        this.style.backgroundColor = originalColor;
                    });
                    
                    // ä¿å­˜åŸå§‹é¡è‰²åˆ°æŒ‰éˆ•å±¬æ€§ï¼Œæ–¹ä¾¿å¾ŒçºŒé‡ç½®
                    btn.dataset.originalColor = originalColor;
                    btn.dataset.hoverColor = hoverColor;
                }
            });
        }

        // è¨­ç½®æ‰€æœ‰å¯é…è‰²DIVçš„éš¨æ©ŸèƒŒæ™¯è‰²ï¼ˆåŒ…å«æœ€å¤–å±¤å®¹å™¨ï¼‰
        function setAllDivRandomColors() {
            // æœ€å¤–å±¤å®¹å™¨
            const outerWrapper = document.getElementById('outerWrapper');
            outerWrapper.style.backgroundColor = getRandomLightColor();
            
            // åŸºç¤è¨ˆç®—å€å¡Š
            const baseSections = document.querySelectorAll('.calc-section');
            baseSections.forEach(div => {
                div.style.backgroundColor = getRandomLightColor();
            });
            
            // ç™¾åˆ†æ¯”å€é–“ç¨ç«‹DIV
            const percentageSections = document.querySelectorAll('.percentage-section');
            percentageSections.forEach(div => {
                div.style.backgroundColor = getRandomLightColor();
            });
        }

        // èª¿æ•´å­—é«”å¤§å°
        function adjustFontSize(scaleChange) {
            currentFontScale += scaleChange;
            currentFontScale = Math.max(minFontScale, Math.min(maxFontScale, currentFontScale));
            const newFontSize = 16 * currentFontScale + 'px';

            const allElements = document.querySelectorAll('div, input, label, table, th, td');
            allElements.forEach(el => el.style.fontSize = newFontSize);
            
            // ä¿æŒæŒ‰éˆ•å…§éƒ¨åœ–æ¨™å¤§å°ä¸è®Š
            const iconButtons = document.querySelectorAll('#calculateBtn, #colorPickerBtn, #fontIncreaseBtn, #fontDecreaseBtn');
            iconButtons.forEach(btn => btn.style.fontSize = '37px');
        }

        // åˆå§‹åŒ–åŸºç¤é¡è‰²ï¼ˆåŒ…å«æœ€å¤–å±¤å®¹å™¨ï¼‰
        setAllDivRandomColors();
        setRandomBtnBgColor();

        // è¼¸å…¥é©—è­‰ - æ­£æ•¸
        function preventNonNumberKey(event, isInteger) {
            const key = event.key;
            const allowedKeys = ['0','1','2','3','4','5','6','7','8','9','Backspace','Delete','ArrowLeft','ArrowRight'];
            if (!isInteger) {
                allowedKeys.push('.');
            }
            if (!allowedKeys.includes(key)) {
                event.preventDefault();
            }
            if (key === '.' && event.target.value.includes('.')) {
                event.preventDefault();
            }
        }

        function validatePositiveNumber(input) {
            let value = input.value.replace(/[^0-9.]/g, '');
            const dotIndex = value.indexOf('.');
            if (dotIndex !== -1) {
                value = value.slice(0, dotIndex + 1) + value.slice(dotIndex + 1).replace(/\./g, '');
            }
            value = value.replace(/^0+(?=\d)/, '0').replace(/^0+(?=\.)/, '0');
            value = value.replace(/-/g, '');
            if (value === '.' || value === '') {
                value = '';
            }
            input.value = value;
            input.classList.toggle('invalid-input', value === '' && input.value !== '');
        }

        // è¼¸å…¥é©—è­‰ - æ­£æ•´æ•¸
        function validatePositiveInteger(input) {
            let value = input.value.replace(/[^0-9]/g, '');
            value = value.replace(/^0+(?=\d)/, '');
            if (value === '') {
                value = '';
            }
            input.value = value;
            input.classList.toggle('invalid-input', value === '' && input.value !== '');
        }

        // è¨ˆç®—ç›ˆè™§
        function calculateProfitLoss() {
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            const currentPrice = parseFloat(document.getElementById('currentPrice').value);

            if (isNaN(buyPrice) || buyPrice <= 0 || buyPrice.toString() === '.') {
                alert('è²·å…¥åƒ¹å¿…é ˆæ˜¯æ­£æ•¸ï¼');
                document.getElementById('buyPrice').focus();
                return;
            }
            if (isNaN(quantity) || quantity <= 0 || !Number.isInteger(quantity)) {
                alert('æ•¸é‡å¿…é ˆæ˜¯æ­£æ•´æ•¸ï¼');
                document.getElementById('quantity').focus();
                return;
            }
            if (isNaN(currentPrice) || currentPrice <= 0 || currentPrice.toString() === '.') {
                alert('ç¾åƒ¹å¿…é ˆæ˜¯æ­£æ•¸ï¼');
                document.getElementById('currentPrice').focus();
                return;
            }

            const totalCost = buyPrice * quantity;
            const currentValue = currentPrice * quantity;
            const profitLoss = currentValue - totalCost;
            const profitLossRate = (profitLoss / totalCost) * 100;

            let realTimeHtml = `
                <p>è²·å…¥ç¸½åƒ¹ï¼š${totalCost.toFixed(2)} å…ƒ</p>
                <p>ç•¶å‰ç¸½åƒ¹ï¼š${currentValue.toFixed(2)} å…ƒ</p>
                <p>ç›ˆè™§é‡‘é¡ï¼š<span class="${profitLoss > 0 ? 'profit' : profitLoss < 0 ? 'loss' : 'neutral'}">${profitLoss.toFixed(2)} å…ƒ</span></p>
                <p>ç›ˆè™§æ¯”ä¾‹ï¼š<span class="${profitLoss > 0 ? 'profit' : profitLoss < 0 ? 'loss' : 'neutral'}">${profitLossRate.toFixed(2)}%</span></p>
            `;
            document.getElementById('realTimeResult').innerHTML = realTimeHtml;

            generatePercentageTables(buyPrice, quantity);
        }

        // ç”Ÿæˆå››å€‹ç¨ç«‹çš„ç™¾åˆ†æ¯”å€é–“DIVï¼ˆåˆ†å…©çµ„æ©«æ’é¡¯ç¤ºï¼‰
        function generatePercentageTables(buyPrice, quantity) {
            const contentContainer = document.getElementById('percentageContent');
            contentContainer.innerHTML = ''; // æ¸…ç©ºåŸæœ‰å…§å®¹

            // åˆ†çµ„å®šç¾©ï¼šç¬¬ä¸€çµ„ï¼ˆ1%-10%ï¼‰ã€ç¬¬äºŒçµ„ï¼ˆ11%-99%ï¼‰
            const groups = [
                {
                    title: '', // çµ„åˆ¥ç„¡å–®ç¨æ¨™é¡Œ
                    items: [
                        { id: 'up1-10', title: 'ä¸Šæ¼² 1% - 10%', start: 1.01, end: 1.10, step: 0.01, type: 'up' },
                        { id: 'down1-10', title: 'ä¸‹è·Œ 1% - 10%', start: 0.99, end: 0.90, step: -0.01, type: 'down' }
                    ]
                },
                {
                    title: '',
                    items: [
                        { id: 'up11-99', title: 'ä¸Šæ¼² 11% - 99%', start: 1.11, end: 1.99, step: 0.01, type: 'up' },
                        { id: 'down11-99', title: 'ä¸‹è·Œ 11% - 99%', start: 0.89, end: 0.01, step: -0.01, type: 'down' }
                    ]
                }
            ];

            // éæ­·åˆ†çµ„ï¼Œç”Ÿæˆå…©æ¬„ä½ˆå±€
            groups.forEach(group => {
                // å‰µå»ºå…©æ¬„ä½ˆå±€å®¹å™¨
                const columnContainer = document.createElement('div');
                columnContainer.className = 'two-column-container';

                // ç”Ÿæˆæ¯æ¬„çš„ç¨ç«‹DIV
                group.items.forEach(section => {
                    // å‰µå»ºç¨ç«‹çš„ç™¾åˆ†æ¯”å€é–“DIV
                    const sectionDiv = document.createElement('div');
                    sectionDiv.id = section.id;
                    sectionDiv.className = 'percentage-section two-column-item'; // æ·»åŠ æ¬„ç›®æ¨£å¼
                    // è¨­ç½®éš¨æ©ŸèƒŒæ™¯è‰²
                    sectionDiv.style.backgroundColor = getRandomLightColor();

                    // å‰µå»ºå€é–“æ¨™é¡Œ
                    const title = document.createElement('h4');
                    title.style.textAlign = 'center';
                    title.style.marginBottom = '10px';
                    title.textContent = section.title;
                    sectionDiv.appendChild(title);

                    // å‰µå»ºè¡¨æ ¼å®¹å™¨
                    const tableContainer = document.createElement('div');
                    tableContainer.className = 'table-container';

                    // å‰µå»ºè¡¨æ ¼
                    const table = document.createElement('table');
                    table.innerHTML = `
                        <thead>
                            <tr>
                                <th>%</</th>
                                <th>è‚¡åƒ¹</</th>
                                <th>ç›ˆè™§</</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    `;

                    // å¡«å……è¡¨æ ¼æ•¸æ“š
                    const tbody = table.querySelector('tbody');
                    for (let rate = section.start; 
                         (section.step > 0 ? rate <= section.end : rate >= section.end); 
                         rate += section.step) {
                        rate = parseFloat(rate.toFixed(2));
                        const displayRate = Math.round((rate - 1) * 100);
                        const price = buyPrice * rate;
                        const profitLoss = (price - buyPrice) * quantity;
                        const className = profitLoss > 0 ? 'profit' : profitLoss < 0 ? 'loss' : 'neutral';
                        
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${displayRate}%</td>
                            <td>${price.toFixed(3)}</td>
                            <td class="${className}">${profitLoss.toFixed(2)} å…ƒ</td>
                        `;
                        tbody.appendChild(tr);
                    }

                    tableContainer.appendChild(table);
                    sectionDiv.appendChild(tableContainer);
                    columnContainer.appendChild(sectionDiv); // åŠ å…¥å…©æ¬„å®¹å™¨
                });

                contentContainer.appendChild(columnContainer); // åŠ å…¥ç¸½å®¹å™¨
            });
        }

        // äº‹ä»¶ç¶å®š - è¨ˆç®—æŒ‰éˆ•
        document.getElementById('calculateBtn').addEventListener('click', calculateProfitLoss);
        // äº‹ä»¶ç¶å®š - è¼¸å…¥æ¡†å›è»Šè¨ˆç®—
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calculateProfitLoss();
                }
            });
        });

        // äº‹ä»¶ç¶å®š - èª¿è‰²ç›¤æŒ‰éˆ•ï¼ˆæ›´æ–°æ‰€æœ‰DIVå’ŒæŒ‰éˆ•é¡è‰²ï¼ŒåŒ…å«æœ€å¤–å±¤å®¹å™¨ï¼‰
        document.getElementById('colorPickerBtn').addEventListener('click', function() {
            // æ›´æ–°æ‰€æœ‰DIVèƒŒæ™¯è‰²ï¼ˆæœ€å¤–å±¤å®¹å™¨ + åŸºç¤å€å¡Š + ç™¾åˆ†æ¯”å€é–“å€å¡Šï¼‰
            setAllDivRandomColors();
            // é‡æ–°è¨­ç½®æŒ‰éˆ•é¡è‰²å’Œæ‡¸æµ®æ•ˆæœ
            setRandomBtnBgColor();
        });

        // äº‹ä»¶ç¶å®š - å­—é«”å¢å¤§/ç¸®å°
        document.getElementById('fontIncreaseBtn').addEventListener('click', function() {
            adjustFontSize(fontStep);
        });
        document.getElementById('fontDecreaseBtn').addEventListener('click', function() {
            adjustFontSize(-fontStep);
        });
    </script>
</body>
</html>
